---
alwaysApply: true
description: 実装中の問題発見時の報告プロセスに関するルール
---

# Problem Reporting Rules

実装中に問題を発見した場合の報告プロセスを定義する。このルールは全タスク種別（🟢/🟡/🔴）に適用される。

## 報告が必要な状況

**MANDATORY**: 実装中に以下の状況を発見した場合、**実装を停止**して報告すること：

### 1. 設計不整合（Design Inconsistencies）

- design.mdが要件をカバーしていない
- 設計の前提が誤っている、または不完全
- 既存コードベースとアーキテクチャが競合

### 2. 曖昧な要件（Ambiguous Requirements）

- requirements.mdにシナリオの動作が未定義
- 複数の解釈が可能
- 実装に必要な情報が不足

### 3. データ/設定の判断が必要（Data/Configuration Decisions）

- データ値の定義が必要（allowedCards、閾値、定数など）
- 設定選択が複数コンポーネントに影響
- ビジネスロジックの判断にドメイン知識が必要

### 4. 不完全な仕様（Incomplete Specifications）

- tasks.mdにエッジケースの処理が未定義
- 検証ルールや制約が不足
- 成功基準が不明確

## 報告方法

### 判断材料の作成

**ファイル**: `.kiro/specs/<feature-name>/decision-material.md` を作成

**内容**:
1. **問題概要（Problem Summary）**: 問題の明確な説明
2. **現状（Current Situation）**: 現在の状況
3. **影響（Impact）**: なぜこれが重要なのか
4. **選択肢（Options）**: 複数の解決策オプション（メリット・デメリット付き）
5. **推奨（Recommendation）**: 推奨するアプローチ（あれば）
6. **質問（Questions）**: ユーザーに必要な具体的な判断事項

### プロセス

1. 判断材料ドキュメントを作成
2. 選択肢を明確に提示
3. **実装を停止**し、ユーザーの判断を待つ
4. **判断が得られるまで実装を進めない**
5. 判断後、承認されたアプローチに従って実装

## 禁止事項

以下の行為は**禁止**：

- ❌ 勝手に判断して実装を進める
- ❌ 要件違反を無視して「簡単な方法」を選ぶ
- ❌ スコープ外の機能を追加する
- ❌ 問題を発見したにもかかわらず報告せずに実装を続ける

## 報告例

### ✅ 報告すべき例

- "JoeyとYugiにallowedCardsが定義されていません。定義すべきですか？選択肢は以下の通りです..."
- "設計ではXを使うとありますが、既存コードはYを使っています。どちらに従うべきですか？"
- "タスクでは機能Xが必要ですが、実装するとYも必要になることが判明しました。Yも追加すべきですか？"

### ❌ 報告すべきでない例（禁止）

- "allowedCardsが未定義なので、バリデーションをスキップします"（要件違反）
- "既存コードがYを使っているので、設計を無視してYを使います"（設計違反の可能性）
- "判断せずにYを追加します"（スコープ外の可能性）

## 適用範囲

このルールは以下のすべてのタスク種別に適用される：

- 🟢 軽量タスク（小さな修正・単純な調査）
- 🟡 標準タスク（機能追加・小さめのリファクタ）
- 🔴 重要タスク（アーキ変更・セキュリティ・コスト影響）

spec-implコマンドだけでなく、すべての実装タスクに適用される。
